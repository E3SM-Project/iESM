




      module mo_adjrxt

      private
      public :: adjrxt

      contains

      subroutine adjrxt( rate, inv, m, ncol )

      use ppgrid, only : pver
      use shr_kind_mod, only : r8 => shr_kind_r8
      use chem_mods, only : nfs, rxntot

      implicit none

!--------------------------------------------------------------------
! ... dummy arguments
!--------------------------------------------------------------------
      integer, intent(in) :: ncol
      real(r8), intent(in) :: inv(ncol,pver,nfs)
      real(r8), intent(in) :: m(ncol,pver)
      real(r8), intent(inout) :: rate(ncol,pver,rxntot)

!--------------------------------------------------------------------
! ... local variables
!--------------------------------------------------------------------
      integer :: k
      real(r8) :: im(ncol)

      do k = 1,pver
         rate(:,k, 73) = rate(:,k, 73) * inv(:,k, 1)
         rate(:,k, 74) = rate(:,k, 74) * inv(:,k, 2)
         rate(:,k, 75) = rate(:,k, 75) * inv(:,k, 3)
         rate(:,k, 93) = rate(:,k, 93) * inv(:,k, 1)
         rate(:,k, 96) = rate(:,k, 96) * inv(:,k, 1)
         rate(:,k,102) = rate(:,k,102) * inv(:,k, 3)
         rate(:,k,105) = rate(:,k,105) * inv(:,k, 1)
         rate(:,k,109) = rate(:,k,109) * inv(:,k, 1)
         rate(:,k,111) = rate(:,k,111) * inv(:,k, 1)
         rate(:,k,112) = rate(:,k,112) * inv(:,k, 1)
         rate(:,k,113) = rate(:,k,113) * inv(:,k, 1)
         rate(:,k,119) = rate(:,k,119) * inv(:,k, 1)
         rate(:,k,121) = rate(:,k,121) * inv(:,k, 1)
         rate(:,k,129) = rate(:,k,129) * inv(:,k, 1)
         rate(:,k,140) = rate(:,k,140) * inv(:,k, 1)
         rate(:,k,142) = rate(:,k,142) * inv(:,k, 1)
         rate(:,k,153) = rate(:,k,153) * inv(:,k, 1)
         rate(:,k,159) = rate(:,k,159) * inv(:,k, 3)
         rate(:,k,164) = rate(:,k,164) * inv(:,k, 1)
         rate(:,k,166) = rate(:,k,166) * inv(:,k, 1)
         rate(:,k,209) = rate(:,k,209) * inv(:,k, 1)
         rate(:,k,210) = rate(:,k,210) * inv(:,k, 1)
         rate(:,k,211) = rate(:,k,211) * inv(:,k, 1)
         rate(:,k,282) = rate(:,k,282) * inv(:,k, 1)
         rate(:,k,286) = rate(:,k,286) * inv(:,k, 1)
         rate(:,k,287) = rate(:,k,287) * inv(:,k, 1)
         rate(:,k,303) = rate(:,k,303) * inv(:,k, 1)
         rate(:,k, 71) = rate(:,k, 71) * inv(:,k, 3) * inv(:,k, 1)
         rate(:,k, 84) = rate(:,k, 84) * inv(:,k, 3) * inv(:,k, 1)
         rate(:,k, 72) = rate(:,k, 72) * m(:,k)
         rate(:,k, 73) = rate(:,k, 73) * m(:,k)
         rate(:,k, 76) = rate(:,k, 76) * m(:,k)
         rate(:,k, 77) = rate(:,k, 77) * m(:,k)
         rate(:,k, 78) = rate(:,k, 78) * m(:,k)
         rate(:,k, 79) = rate(:,k, 79) * m(:,k)
         rate(:,k, 80) = rate(:,k, 80) * m(:,k)
         rate(:,k, 81) = rate(:,k, 81) * m(:,k)
         rate(:,k, 82) = rate(:,k, 82) * m(:,k)
         rate(:,k, 83) = rate(:,k, 83) * m(:,k)
         rate(:,k, 85) = rate(:,k, 85) * m(:,k)
         rate(:,k, 86) = rate(:,k, 86) * m(:,k)
         rate(:,k, 87) = rate(:,k, 87) * m(:,k)
         rate(:,k, 88) = rate(:,k, 88) * m(:,k)
         rate(:,k, 89) = rate(:,k, 89) * m(:,k)
         rate(:,k, 90) = rate(:,k, 90) * m(:,k)
         rate(:,k, 91) = rate(:,k, 91) * m(:,k)
         rate(:,k, 92) = rate(:,k, 92) * m(:,k)
         rate(:,k, 93) = rate(:,k, 93) * m(:,k)
         rate(:,k, 94) = rate(:,k, 94) * m(:,k)
         rate(:,k, 95) = rate(:,k, 95) * m(:,k)
         rate(:,k, 96) = rate(:,k, 96) * m(:,k)
         rate(:,k, 97) = rate(:,k, 97) * m(:,k)
         rate(:,k, 98) = rate(:,k, 98) * m(:,k)
         rate(:,k, 99) = rate(:,k, 99) * m(:,k)
         rate(:,k,100) = rate(:,k,100) * m(:,k)
         rate(:,k,101) = rate(:,k,101) * m(:,k)
         rate(:,k,103) = rate(:,k,103) * m(:,k)
         rate(:,k,104) = rate(:,k,104) * m(:,k)
         rate(:,k,105) = rate(:,k,105) * m(:,k)
         rate(:,k,106) = rate(:,k,106) * m(:,k)
         rate(:,k,107) = rate(:,k,107) * m(:,k)
         rate(:,k,108) = rate(:,k,108) * m(:,k)
         rate(:,k,109) = rate(:,k,109) * m(:,k)
         rate(:,k,110) = rate(:,k,110) * m(:,k)
         rate(:,k,111) = rate(:,k,111) * m(:,k)
         rate(:,k,113) = rate(:,k,113) * m(:,k)
         rate(:,k,114) = rate(:,k,114) * m(:,k)
         rate(:,k,115) = rate(:,k,115) * m(:,k)
         rate(:,k,116) = rate(:,k,116) * m(:,k)
         rate(:,k,117) = rate(:,k,117) * m(:,k)
         rate(:,k,118) = rate(:,k,118) * m(:,k)
         rate(:,k,119) = rate(:,k,119) * m(:,k)
         rate(:,k,120) = rate(:,k,120) * m(:,k)
         rate(:,k,122) = rate(:,k,122) * m(:,k)
         rate(:,k,123) = rate(:,k,123) * m(:,k)
         rate(:,k,124) = rate(:,k,124) * m(:,k)
         rate(:,k,125) = rate(:,k,125) * m(:,k)
         rate(:,k,126) = rate(:,k,126) * m(:,k)
         rate(:,k,127) = rate(:,k,127) * m(:,k)
         rate(:,k,128) = rate(:,k,128) * m(:,k)
         rate(:,k,129) = rate(:,k,129) * m(:,k)
         rate(:,k,130) = rate(:,k,130) * m(:,k)
         rate(:,k,131) = rate(:,k,131) * m(:,k)
         rate(:,k,132) = rate(:,k,132) * m(:,k)
         rate(:,k,133) = rate(:,k,133) * m(:,k)
         rate(:,k,134) = rate(:,k,134) * m(:,k)
         rate(:,k,135) = rate(:,k,135) * m(:,k)
         rate(:,k,136) = rate(:,k,136) * m(:,k)
         rate(:,k,138) = rate(:,k,138) * m(:,k)
         rate(:,k,139) = rate(:,k,139) * m(:,k)
         rate(:,k,140) = rate(:,k,140) * m(:,k)
         rate(:,k,141) = rate(:,k,141) * m(:,k)
         rate(:,k,142) = rate(:,k,142) * m(:,k)
         rate(:,k,143) = rate(:,k,143) * m(:,k)
         rate(:,k,144) = rate(:,k,144) * m(:,k)
         rate(:,k,145) = rate(:,k,145) * m(:,k)
         rate(:,k,146) = rate(:,k,146) * m(:,k)
         rate(:,k,147) = rate(:,k,147) * m(:,k)
         rate(:,k,148) = rate(:,k,148) * m(:,k)
         rate(:,k,149) = rate(:,k,149) * m(:,k)
         rate(:,k,150) = rate(:,k,150) * m(:,k)
         rate(:,k,151) = rate(:,k,151) * m(:,k)
         rate(:,k,152) = rate(:,k,152) * m(:,k)
         rate(:,k,153) = rate(:,k,153) * m(:,k)
         rate(:,k,154) = rate(:,k,154) * m(:,k)
         rate(:,k,155) = rate(:,k,155) * m(:,k)
         rate(:,k,156) = rate(:,k,156) * m(:,k)
         rate(:,k,157) = rate(:,k,157) * m(:,k)
         rate(:,k,158) = rate(:,k,158) * m(:,k)
         rate(:,k,161) = rate(:,k,161) * m(:,k)
         rate(:,k,162) = rate(:,k,162) * m(:,k)
         rate(:,k,163) = rate(:,k,163) * m(:,k)
         rate(:,k,165) = rate(:,k,165) * m(:,k)
         rate(:,k,166) = rate(:,k,166) * m(:,k)
         rate(:,k,167) = rate(:,k,167) * m(:,k)
         rate(:,k,168) = rate(:,k,168) * m(:,k)
         rate(:,k,169) = rate(:,k,169) * m(:,k)
         rate(:,k,170) = rate(:,k,170) * m(:,k)
         rate(:,k,171) = rate(:,k,171) * m(:,k)
         rate(:,k,172) = rate(:,k,172) * m(:,k)
         rate(:,k,173) = rate(:,k,173) * m(:,k)
         rate(:,k,174) = rate(:,k,174) * m(:,k)
         rate(:,k,175) = rate(:,k,175) * m(:,k)
         rate(:,k,176) = rate(:,k,176) * m(:,k)
         rate(:,k,177) = rate(:,k,177) * m(:,k)
         rate(:,k,178) = rate(:,k,178) * m(:,k)
         rate(:,k,179) = rate(:,k,179) * m(:,k)
         rate(:,k,180) = rate(:,k,180) * m(:,k)
         rate(:,k,181) = rate(:,k,181) * m(:,k)
         rate(:,k,182) = rate(:,k,182) * m(:,k)
         rate(:,k,183) = rate(:,k,183) * m(:,k)
         rate(:,k,184) = rate(:,k,184) * m(:,k)
         rate(:,k,185) = rate(:,k,185) * m(:,k)
         rate(:,k,186) = rate(:,k,186) * m(:,k)
         rate(:,k,187) = rate(:,k,187) * m(:,k)
         rate(:,k,188) = rate(:,k,188) * m(:,k)
         rate(:,k,189) = rate(:,k,189) * m(:,k)
         rate(:,k,190) = rate(:,k,190) * m(:,k)
         rate(:,k,191) = rate(:,k,191) * m(:,k)
         rate(:,k,192) = rate(:,k,192) * m(:,k)
         rate(:,k,193) = rate(:,k,193) * m(:,k)
         rate(:,k,194) = rate(:,k,194) * m(:,k)
         rate(:,k,195) = rate(:,k,195) * m(:,k)
         rate(:,k,196) = rate(:,k,196) * m(:,k)
         rate(:,k,197) = rate(:,k,197) * m(:,k)
         rate(:,k,198) = rate(:,k,198) * m(:,k)
         rate(:,k,199) = rate(:,k,199) * m(:,k)
         rate(:,k,200) = rate(:,k,200) * m(:,k)
         rate(:,k,201) = rate(:,k,201) * m(:,k)
         rate(:,k,202) = rate(:,k,202) * m(:,k)
         rate(:,k,203) = rate(:,k,203) * m(:,k)
         rate(:,k,204) = rate(:,k,204) * m(:,k)
         rate(:,k,205) = rate(:,k,205) * m(:,k)
         rate(:,k,206) = rate(:,k,206) * m(:,k)
         rate(:,k,207) = rate(:,k,207) * m(:,k)
         rate(:,k,208) = rate(:,k,208) * m(:,k)
         rate(:,k,209) = rate(:,k,209) * m(:,k)
         rate(:,k,211) = rate(:,k,211) * m(:,k)
         rate(:,k,212) = rate(:,k,212) * m(:,k)
         rate(:,k,213) = rate(:,k,213) * m(:,k)
         rate(:,k,214) = rate(:,k,214) * m(:,k)
         rate(:,k,215) = rate(:,k,215) * m(:,k)
         rate(:,k,216) = rate(:,k,216) * m(:,k)
         rate(:,k,217) = rate(:,k,217) * m(:,k)
         rate(:,k,218) = rate(:,k,218) * m(:,k)
         rate(:,k,219) = rate(:,k,219) * m(:,k)
         rate(:,k,220) = rate(:,k,220) * m(:,k)
         rate(:,k,221) = rate(:,k,221) * m(:,k)
         rate(:,k,222) = rate(:,k,222) * m(:,k)
         rate(:,k,223) = rate(:,k,223) * m(:,k)
         rate(:,k,224) = rate(:,k,224) * m(:,k)
         rate(:,k,225) = rate(:,k,225) * m(:,k)
         rate(:,k,226) = rate(:,k,226) * m(:,k)
         rate(:,k,227) = rate(:,k,227) * m(:,k)
         rate(:,k,228) = rate(:,k,228) * m(:,k)
         rate(:,k,229) = rate(:,k,229) * m(:,k)
         rate(:,k,230) = rate(:,k,230) * m(:,k)
         rate(:,k,231) = rate(:,k,231) * m(:,k)
         rate(:,k,232) = rate(:,k,232) * m(:,k)
         rate(:,k,233) = rate(:,k,233) * m(:,k)
         rate(:,k,234) = rate(:,k,234) * m(:,k)
         rate(:,k,235) = rate(:,k,235) * m(:,k)
         rate(:,k,236) = rate(:,k,236) * m(:,k)
         rate(:,k,237) = rate(:,k,237) * m(:,k)
         rate(:,k,238) = rate(:,k,238) * m(:,k)
         rate(:,k,239) = rate(:,k,239) * m(:,k)
         rate(:,k,240) = rate(:,k,240) * m(:,k)
         rate(:,k,241) = rate(:,k,241) * m(:,k)
         rate(:,k,242) = rate(:,k,242) * m(:,k)
         rate(:,k,243) = rate(:,k,243) * m(:,k)
         rate(:,k,244) = rate(:,k,244) * m(:,k)
         rate(:,k,245) = rate(:,k,245) * m(:,k)
         rate(:,k,246) = rate(:,k,246) * m(:,k)
         rate(:,k,247) = rate(:,k,247) * m(:,k)
         rate(:,k,248) = rate(:,k,248) * m(:,k)
         rate(:,k,249) = rate(:,k,249) * m(:,k)
         rate(:,k,255) = rate(:,k,255) * m(:,k)
         rate(:,k,256) = rate(:,k,256) * m(:,k)
         rate(:,k,257) = rate(:,k,257) * m(:,k)
         rate(:,k,258) = rate(:,k,258) * m(:,k)
         rate(:,k,259) = rate(:,k,259) * m(:,k)
         rate(:,k,262) = rate(:,k,262) * m(:,k)
         rate(:,k,263) = rate(:,k,263) * m(:,k)
         rate(:,k,264) = rate(:,k,264) * m(:,k)
         rate(:,k,265) = rate(:,k,265) * m(:,k)
         rate(:,k,266) = rate(:,k,266) * m(:,k)
         rate(:,k,267) = rate(:,k,267) * m(:,k)
         rate(:,k,268) = rate(:,k,268) * m(:,k)
         rate(:,k,269) = rate(:,k,269) * m(:,k)
         rate(:,k,270) = rate(:,k,270) * m(:,k)
         rate(:,k,271) = rate(:,k,271) * m(:,k)
         rate(:,k,272) = rate(:,k,272) * m(:,k)
         rate(:,k,273) = rate(:,k,273) * m(:,k)
         rate(:,k,274) = rate(:,k,274) * m(:,k)
         rate(:,k,275) = rate(:,k,275) * m(:,k)
         rate(:,k,276) = rate(:,k,276) * m(:,k)
         rate(:,k,277) = rate(:,k,277) * m(:,k)
         rate(:,k,278) = rate(:,k,278) * m(:,k)
         rate(:,k,279) = rate(:,k,279) * m(:,k)
         rate(:,k,280) = rate(:,k,280) * m(:,k)
         rate(:,k,281) = rate(:,k,281) * m(:,k)
         rate(:,k,282) = rate(:,k,282) * m(:,k)
         rate(:,k,283) = rate(:,k,283) * m(:,k)
         rate(:,k,284) = rate(:,k,284) * m(:,k)
         rate(:,k,285) = rate(:,k,285) * m(:,k)
         rate(:,k,286) = rate(:,k,286) * m(:,k)
         rate(:,k,288) = rate(:,k,288) * m(:,k)
         rate(:,k,289) = rate(:,k,289) * m(:,k)
         rate(:,k,290) = rate(:,k,290) * m(:,k)
         rate(:,k,291) = rate(:,k,291) * m(:,k)
         rate(:,k,292) = rate(:,k,292) * m(:,k)
         rate(:,k,293) = rate(:,k,293) * m(:,k)
         rate(:,k,294) = rate(:,k,294) * m(:,k)
         rate(:,k,295) = rate(:,k,295) * m(:,k)
         rate(:,k,296) = rate(:,k,296) * m(:,k)
         rate(:,k,297) = rate(:,k,297) * m(:,k)
         rate(:,k,298) = rate(:,k,298) * m(:,k)
         rate(:,k,299) = rate(:,k,299) * m(:,k)
         rate(:,k,300) = rate(:,k,300) * m(:,k)
         rate(:,k,301) = rate(:,k,301) * m(:,k)
         rate(:,k,302) = rate(:,k,302) * m(:,k)
         rate(:,k,303) = rate(:,k,303) * m(:,k)
         rate(:,k,304) = rate(:,k,304) * m(:,k)
         rate(:,k,305) = rate(:,k,305) * m(:,k)
         rate(:,k,306) = rate(:,k,306) * m(:,k)
         rate(:,k,307) = rate(:,k,307) * m(:,k)
         rate(:,k,308) = rate(:,k,308) * m(:,k)
         rate(:,k,309) = rate(:,k,309) * m(:,k)
         rate(:,k,310) = rate(:,k,310) * m(:,k)
         rate(:,k,311) = rate(:,k,311) * m(:,k)
         rate(:,k,312) = rate(:,k,312) * m(:,k)
         rate(:,k,313) = rate(:,k,313) * m(:,k)
         rate(:,k,314) = rate(:,k,314) * m(:,k)
         rate(:,k,315) = rate(:,k,315) * m(:,k)
         rate(:,k,316) = rate(:,k,316) * m(:,k)
         rate(:,k,320) = rate(:,k,320) * m(:,k)
         rate(:,k,321) = rate(:,k,321) * m(:,k)
         rate(:,k,322) = rate(:,k,322) * m(:,k)
         rate(:,k,325) = rate(:,k,325) * m(:,k)
         rate(:,k,326) = rate(:,k,326) * m(:,k)
         rate(:,k,331) = rate(:,k,331) * m(:,k)
         rate(:,k,332) = rate(:,k,332) * m(:,k)
         rate(:,k,333) = rate(:,k,333) * m(:,k)
      end do

      end subroutine adjrxt

      end module mo_adjrxt
